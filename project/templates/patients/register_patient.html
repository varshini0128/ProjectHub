{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}Patient Registration - HealthChain{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0"><i class="bi bi-person-plus-fill"></i> Patient Registration</h3>
                </div>
                <div class="card-body">
                    <form method="POST">
                        {% csrf_token %}
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    {{ form.username|as_crispy_field }}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    {{ form.full_name|as_crispy_field }}
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    {{ form.password|as_crispy_field }}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    {{ form.confirm_password|as_crispy_field }}
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    {{ form.date_of_birth|as_crispy_field }}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    {{ form.phone_number|as_crispy_field }}
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group mb-3">
                            {{ form.address|as_crispy_field }}
                        </div>
                        
                        <div class="form-group mb-3">
                            {{ form.problem|as_crispy_field }}
                        </div>
                        
                        <div class="form-group mb-3">
                            {{ form.hospital|as_crispy_field }}
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    {{ form.security_question|as_crispy_field }}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group mb-3">
                                    {{ form.security_answer|as_crispy_field }}
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group mt-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="terms" required>
                                <label class="form-check-label" for="terms">
                                    I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">Terms and Conditions</a> and <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">Privacy Policy</a>
                                </label>
                            </div>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-person-plus"></i> Register
                            </button>
                        </div>
                    </form>
                </div>
                <div class="card-footer">
                    <div class="text-center">
                        Already have an account? <a href="{% url 'login' %}">Log in here</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Terms Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Terms and Conditions</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h4>HealthChain Terms of Service</h4>
                <p>These Terms of Service govern your use of the HealthChain platform for secure patient data management. By using our services, you agree to these terms.</p>
                
                <h5>1. Data Security and Privacy</h5>
                <p>We use blockchain technology to secure your medical records. While we take every measure to protect your data, no system is completely immune to security risks. You are responsible for keeping your login credentials secure.</p>
                
                <h5>2. Patient Rights and Responsibilities</h5>
                <p>As a patient, you have the right to access your medical records and control who has access to them. You are responsible for providing accurate information during registration and ensuring your profile information remains up-to-date.</p>
                
                <h5>3. Hospital Rights and Responsibilities</h5>
                <p>Hospitals must maintain appropriate licenses and credentials to use this platform. Hospitals are responsible for the accuracy of medical records they create and must obtain proper patient consent before accessing records.</p>
                
                <h5>4. Limitation of Liability</h5>
                <p>HealthChain is not liable for any damages arising from your use of the service or any unauthorized access to your information that is not a result of our negligence.</p>
                
                <h5>5. Modifications to Terms</h5>
                <p>We may modify these terms at any time. Continued use of the platform after changes constitutes agreement to the updated terms.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">I Understand</button>
            </div>
        </div>
    </div>
</div>

<!-- Privacy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Privacy Policy</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h4>HealthChain Privacy Policy</h4>
                <p>This Privacy Policy explains how HealthChain collects, uses, and protects your personal health information.</p>
                
                <h5>1. Information We Collect</h5>
                <p>We collect the personal and medical information you provide during registration and throughout your use of the platform, including your name, contact information, medical conditions, and treatment records.</p>
                
                <h5>2. How We Use Your Information</h5>
                <p>Your information is used to create and maintain your medical records, facilitate healthcare provider access (with your consent), and ensure the security of your data through blockchain verification.</p>
                
                <h5>3. Blockchain Security</h5>
                <p>We use blockchain technology to secure your data. This involves creating encrypted records that cannot be altered without detection, ensuring the integrity of your medical information.</p>
                
                <h5>4. Data Sharing</h5>
                <p>Your data is only shared with healthcare providers you explicitly authorize. We do not sell, rent, or share your personal information with third parties for marketing purposes.</p>
                
                <h5>5. Your Rights</h5>
                <p>You have the right to access, correct, and delete your personal information, subject to certain limitations related to the immutable nature of blockchain records.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">I Understand</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}